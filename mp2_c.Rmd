---
title: "Mini-Project 2"
author: "Your Name Here"
date: "2019-03-24"
output: 
  html_document:
    code_folding: show
---


## Loading the data

This project is so interesting and relevant to my life!

```{r, message=FALSE}
library(tidyverse)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
library(plyr)
library(ggthemes)
```

```{r}
##filter by year, MA, by DEM and REP ----
filtered_data <- candidates %>%
  filter ( cand_election_yr == 2012)%>%
  filter (cand_office_state == "MA")%>%
  filter (cand_party_affiliation %in% c("DEM", "REP"))
```

```{r}
##joing candidates and contributions data frame ----

joined_data <- filtered_data %>%
  inner_join(contributions, by = "cand_id")%>%
  filter(transaction_type %in% c("24A", "24E"))%>%
  filter (transaction_pgi %in% c ("G", "G2012"))
```

```{r}
##making two datasets for two parties ----
dem <- joined_data %>%
  filter (cand_party_affiliation == "DEM")

rep <- joined_data %>%
  filter (cand_party_affiliation == "REP")
```

```{r}
dem$transaction_pgi <- revalue(dem$transaction_pgi, c("G2012" = "G"))
rep$transaction_pgi <- revalue(rep$transaction_pgi, c("G2012" = "G"))
```

```{r}
detach(package:plyr)
```



```{r}
## SUmmarising the total amount for and against the democrats and Repulican ----
bar<- joined_data %>%
  group_by(transaction_type, cand_party_affiliation)%>%
  summarise(total = sum(transaction_amt))%>%
  ungroup()%>%
  group_by(cand_party_affiliation)

bar_dem <- dem %>%
  group_by(cand_id, transaction_type)%>%
  summarise(cand_name = cand_name[1],total = sum(transaction_amt))
```

```{r}
##making a bar graph to plot the summarise data ----
ggplot(bar, aes(x = cand_party_affiliation, y = total/100000, fill = transaction_type))+
  geom_bar(stat = "identity", position = "dodge")+
  scale_y_continuous(limits = c(0,50), expand = c(0, 0))+
  theme_classic()+
  labs(title = "Amount Spent by the Committees'For' and 'Against' Candidates of the Two Major Parties", x = "Party Affiliation", y = "Amount donated (in $100,000)")+
  theme(axis.text.x=element_blank())
  
```

```{r}
##contribution to each democractic candidate ---- 
ggplot(bar_dem, aes(x = cand_name,y = total, fill = transaction_type))+
  geom_bar(stat = "identity", position = "dodge")+
  scale_y_continuous(limits = c(0,3000000), expand = c(0, 0))+
  theme_classic()+
  theme_classic()+
  theme(axis.text.x=element_blank())+
  facet_wrap(~cand_name)
  
```






